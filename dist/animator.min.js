/*!
 * Animator.js - v1.0.0
 * @author Gao Sun
 * @license MIT
 * @homepage https://gao-sun.github.io/animatorjs
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Animator=t():e.Animator=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={};i.convertToObject=function(e){var t=e.substring(e.indexOf("{")+1).trim().slice(0,-1),n={};return t.split(";").map(function(e){if(e=e.trim()){var t=e.split(":");n[t[0].trim()]=t[1].trim()}}),n},i.getFromSheets=function(e){var t=document.styleSheets;for(var n in t){var r=null;try{r=t[n].rules||t[n].cssRules}catch(e){}if(r)for(var s in r)if(r[s].selectorText&&r[s].selectorText.split(",").indexOf(e)!=-1)return r[s].cssText?i.convertToObject(r[s].cssText):i.convertToObject(r[s].style.cssText)}return{}},i.getPropertyDefault=function(e){return"timing-function"==e?"ease":"iteration-count"==e?1:"direction"==e?"normal":"fill-mode"==e?"none":null},t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={};i.generateId=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<8;++n)e+=t.charAt(Math.floor(Math.random()*t.length));return e},i.frameToString=function(e){var t="";for(var n in e)t+=n+":"+e[n]+";";return t},i.convertTimeToMs=function(e){if(!e)return 0;if("number"==typeof e)return e;var t=parseFloat(e);return e.indexOf("ms")!=-1?t:1e3*t},i.prefixes=["","-webkit-","-moz-","-o-"],t.default=i},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),o=i(s),a=function e(t,n){if(r(this,e),this.styles="string"==typeof t?o.default.getFromSheets(t):t,"string"==typeof n){var i=o.default.getFromSheets(n);this.options={};for(var s in i)this.options[s.replace("animation-","")]=i[s]}else this.options="number"==typeof n?{duration:n}:n};t.default=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(4),a=i(o),u=n(1),f=i(u),l=n(0),m=i(l),h=function(){function e(t,n,i,s){if(r(this,e),t.constructor===Array?this.doms=t:this.doms=[t],n.constructor===Array?this.frames=n:this.frames=[n],this.options={startFrom:0,pauseAt:[],prefix:!1,count:1,clear:!0,applyOnEnd:!1,instant:!1},null!=i&&void 0!=i)if("boolean"==typeof i)this.options.instant=i;else if("number"==typeof i)this.options.count=i,"boolean"==typeof s&&(this.options.instant=s);else for(var o in i)"pauseAt"==o&&i.pauseAt.constructor!==Array?this.options[o]=[i[o]]:this.options[o]=i[o];this.promiseSupported="undefined"!=typeof Promise&&Promise.toString().indexOf("[native code]")!==-1,this.countRemainder=[],this.animations=[],this.styleDoms=[],this.superSets=[],this.eventHandler=[],this.options.prefix?this.prefixes=f.default.prefixes:this.prefixes=[""];for(var a in t)this.countRemainder[a]=this.options.count-1;this.options.instant&&this.play()}return s(e,[{key:"play",value:function(){var e=this;this.clear(),this.promiseSupported&&(this.promise=new Promise(function(t){e.promiseResolve=t}));for(var t in this.doms){var n=this.makeAnimation(this.doms[t]);this.animations[t]=n.names,this.styleDoms[t]=n.styleDom,this.superSets[t]=this.makeSuperSet(this.doms[t],this.animations[t]),this.playAnimation(this.doms[t],this.superSets[t]),this.eventHandler[t]=this.handleAnimationEnd.bind(this,t),this.doms[t].addEventListener("animationend",this.eventHandler[t])}if(this.promiseSupported)return this.promise}},{key:"clear",value:function(e){if(!e){for(var t in this.doms)this.clear(t);return this.animationEnded=0,this.promise=void 0,void(this.promiseResolve=void 0)}var n=this.styleDoms[e];n&&n.parentNode&&n.parentNode.removeChild(n);for(var i in this.superSets[e])for(var r in this.prefixes)this.doms[e].style[this.prefixes[r]+"animation-"+i]=null;for(var s in this.prefixes)this.doms[e].style[this.prefixes[s]+"animation-play-state"]=null;this.doms[e].removeEventListener("animationend",this.eventHandler[e]),this.countRemainder[e]=this.options.count-1}},{key:"replay",value:function(e){var t=this.doms[e],n=t.cloneNode(!0);t.parentNode.replaceChild(n,t),this.doms[e].removeEventListener("animationend",this.eventHandler[e]),this.doms[e]=n,this.doms[e].addEventListener("animationend",this.eventHandler[e])}},{key:"pause",value:function(){for(var e in this.doms)this.pauseDom(this.doms[e])}},{key:"resume",value:function(){for(var e in this.doms)this.resumeDom(this.doms[e])}},{key:"getPromise",value:function(){return this.promise}},{key:"handleAnimationEnd",value:function(e,t){var n=t.animationName,i=n.substring(n.lastIndexOf("-")+1);this.options.pauseAt.includes(parseInt(i))&&this.pauseDom(this.doms[e]),i==this.frames.length&&(this.countRemainder[e]==-1?this.replay(e):this.countRemainder[e]>0?(this.countRemainder[e]--,this.replay(e)):(this.options.applyOnEnd&&this.applyOnEnd(e),++this.animationEnded==this.doms.length&&(this.promiseSupported&&this.promiseResolve(),this.options.clear&&this.clear())))}},{key:"pauseDom",value:function(e){for(var t in this.prefixes)e.style[this.prefixes[t]+"animation-play-state"]="paused"}},{key:"resumeDom",value:function(e){for(var t in this.prefixes)e.style[this.prefixes[t]+"animation-play-state"]="running"}},{key:"applyOnEnd",value:function(e){var t=this.newFrames[this.frames.length];for(var n in t)this.doms[e].style[n]=t[n]}},{key:"makeAnimation",value:function(e){var t={},n=[],i={};for(var r in this.frames){n.push(this.frames[r].styles);for(var s in n[r])i[s]=!0}var o=window.getComputedStyle(e);for(var u in i)t[u]=o[u];n.unshift(t);for(var f=[n[0]],l=1;l<n.length;++l){var m=JSON.parse(JSON.stringify(f[l-1]));for(var h in n[l])m[h]=n[l][h];f.push(m)}return this.newFrames=f,a.default.make(f,this.prefixes)}},{key:"makeSuperSet",value:function(e,t){var n=0,i={};for(var r in this.frames)for(var s in this.frames[r].options)i[s]="";i.name="",i.duration="",i.delay="";for(var o=0;o<this.frames.length;++o){if(o)for(var a in i)i[a]+=",";var u=f.default.convertTimeToMs(this.frames[o].options.duration),l=f.default.convertTimeToMs(this.frames[o].options.delay);o<this.options.startFrom&&(u=0,l=0),i.name+=t[o],i.duration+=u+"ms",i.delay+=n+l+"ms";for(var h in i)"name"!=h&&"duration"!=h&&"delay"!=h&&(i[h]+=this.frames[o].options[h]?this.frames[o].options[h]:m.default.getPropertyDefault(h));var p=this.frames[o].options["iteration-count"];n+=u*parseInt(p?p:1)+l}return i}},{key:"playAnimation",value:function(e,t){for(var n in t)for(var i in this.prefixes)e.style[this.prefixes[i]+"animation-"+n]=t[n];this.options.pauseAt.includes(0)&&this.pauseDom(e)}}]),e}();t.default=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=i(r),o={};o.make=function(e,t){for(var n=[],i="",r="atr-"+s.default.generateId(),a=document.createElement("style"),u=0;u<e.length-1;++u)n.push(r+"-"+(u+1)),i+=o.makeFromTwoFrames(e[u],e[u+1],n[u],t);return a.innerHTML=i,a.class="foo",document.getElementsByTagName("head")[0].appendChild(a),{names:n,styleDom:a}},o.makeFromTwoFrames=function(e,t,n,i){var r="";for(var o in i)r+="@"+i[o]+"keyframes "+n+" {",r+="0%",r+="{"+s.default.frameToString(e)+"}",r+="100%",r+="{"+s.default.frameToString(t)+"}",r+="}";return r},t.default=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=t.Frame=void 0;var r=n(2),s=i(r),o=n(3),a=i(o);t.Frame=s.default,t.Queue=a.default}])});